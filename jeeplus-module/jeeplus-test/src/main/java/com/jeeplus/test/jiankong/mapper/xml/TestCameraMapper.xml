<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jeeplus.test.jiankong.mapper.TestCameraMapper">

    <!-- 定义查询字段 -->
    <sql id="testCameraColumns">
        a.id AS "id",
        a.name AS "name",
        a.address AS "address",
        a.remarks AS "remarks",

        a.create_by AS "createBy.id",
        a.create_date AS "createDate",
        a.update_by AS "updateBy.id",
        a.update_date AS "updateDate",
        a.del_flag AS "delFlag"
    </sql>

    <!-- 查询摄像头列表 -->
    <select id="findList" resultType="com.jeeplus.test.jiankong.service.dto.TestCameraDTO">
        SELECT
        <include refid="testCameraColumns"/>
        FROM test_camera a
        WHERE a.del_flag = '0'
        ${ew.customSqlSegment}
    </select>

    <!-- 根据 ID 查询摄像头信息 -->
    <select id="findById" resultType="com.jeeplus.test.jiankong.service.dto.TestCameraDTO">
        SELECT
        <include refid="testCameraColumns"/>
        FROM test_camera a
        WHERE a.id = #{id} AND a.del_flag = '0'
    </select>

    <!-- 插入摄像头信息 -->
    <insert id="insertCamera" parameterType="com.jeeplus.test.jiankong.service.dto.TestCameraDTO">
        INSERT INTO test_camera (id, name, address, remarks, create_by, create_date, update_by, update_date, del_flag)
        VALUES (#{id}, #{name}, #{address}, #{remarks}, #{createBy.id}, #{createDate}, #{updateBy.id}, #{updateDate}, '0')
    </insert>

    <!-- 更新摄像头信息 -->
    <update id="updateCamera" parameterType="com.jeeplus.test.jiankong.service.dto.TestCameraDTO">
        UPDATE test_camera
        SET name = #{name},
            address = #{address},
            remarks = #{remarks},
            update_by = #{updateBy.id},
            update_date = #{updateDate}
        WHERE id = #{id} AND del_flag = '0'
    </update>

    <!-- 删除摄像头信息（逻辑删除） -->
    <update id="deleteCamera" parameterType="java.lang.String">
        UPDATE test_camera
        SET del_flag = '1'
        WHERE id = #{id}
    </update>

</mapper>